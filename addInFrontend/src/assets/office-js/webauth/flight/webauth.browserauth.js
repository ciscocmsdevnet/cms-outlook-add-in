!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("BrowserAuth",[],t):"object"==typeof exports?exports.BrowserAuth=t():e.BrowserAuth=t()}(window,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}({"./packages/Microsoft.Office.WebAuth.BrowserAuth/lib/api.js":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logUserAction=function(e,t,r,n,o,i,s){void 0===t&&(t=!0);void 0===r&&(r=u);void 0===n&&(n=u);void 0===o&&(o=u);void 0===i&&(i=0);void 0===s&&(s=[]);l({name:null,actionName:e,commandSurface:o,parentName:r,triggerMethod:n,durationMs:i,succeeded:t,dataFields:s})},t.logActivity=function(e,t,r,n){void 0===t&&(t=!0);void 0===r&&(r=0);void 0===n&&(n=[]);c({name:e,succeeded:t,durationMs:r,dataFields:n})},t.sendTelemetryEvent=function(e){d({kind:"event",event:e,timestamp:(new Date).getTime()})},t.sendActivityEvent=c,t.sendOtelEvent=function(e){d({kind:"otel",event:e})},t.sendUserActionEvent=l,t.addNamespaceMapping=function(e,t){d({kind:"addNamespaceMapping",namespace:e,ariaTenantToken:t})},t.setEnabledState=function(e){(o=e)||(i=[])},t.shutdown=function(){return d({kind:"shutdown"}),i.length+s},t.registerEventHandler=function(e){n=e,i.forEach(function(e){return d(e)}),i=[]};var n,o=!1,i=[],s=0,a=2e4,u="Unknown";function c(e){d({kind:"activity",event:e,timestamp:(new Date).getTime()})}function l(e){d({kind:"action",event:e,timestamp:(new Date).getTime()})}function d(e){o&&(n?n(e):i.length<=a?i.push(e):s+=1)}},"./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/BrowserAuth.ts":function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function s(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(s,a)}u((n=n.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var i,s,a,u=r("./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/Constants.ts"),c=r("./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/LoggingUtils.ts"),l=r("./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/ValidateUtils.ts"),d=r("./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/TimerUtils.ts"),g=r("./packages/Microsoft.Office.WebAuth.BrowserAuth/lib/api.js");function f(e,t){var r=d.TimerUtils.timer();(a=e).enableConsoleLogging&&(c.LoggingUtils.enableConsoleLogging=a.enableConsoleLogging),a.enableUpnCheck&&(l.ValidateUtils.enableUpnCheck=a.enableUpnCheck),a.authority&&(a.authority=a.authority.replace(u.Constants.Authority.ProdLegacy,u.Constants.Authority.Prod));var n=a.idp.toLowerCase()===u.Constants.IdentityProvider.Msa.toLowerCase();return n?a.authority=u.Constants.Authority.Prod+u.Constants.Authority.MsaSuffix:(a.authority||(a.authority=u.Constants.Authority.Prod+u.Constants.Authority.AadSuffix),a.authority.indexOf(u.Constants.Authority.AadSuffix)<0&&("/"==a.authority.charAt(a.authority.length-1)?a.authority+=u.Constants.Authority.AadSuffix:a.authority+="/"+u.Constants.Authority.AadSuffix)),function(e){void 0===e&&(e=2e3);return new Promise(function(t,r){var n=0,o=setInterval(function(){return n+=500,function(){try{return void 0!==msal&&!!msal}catch(e){return!1}}()?(clearInterval(o),t(msal)):n>e?(clearInterval(o),r(null)):void 0},500)})}(a.timeoutToLoad?a.timeoutToLoad:2e3).then(function(e){var o;s=new Array;for(var i=0,d=a.appIds;i<d.length;i++){var g=d[i];if(c.LoggingUtils.log("[Load->MsalWrapper->MsalInit] "+g+": "+a.idp),g&&l.ValidateUtils.isGuid(g)){var f={applicationId:g,application:new e.PublicClientApplication({auth:{clientId:g,authority:a.authority,redirectUri:a.redirectUri?a.redirectUri.split("?")[0]:location.href.split("?")[0],navigateToLoginRequestUrl:!a.navigateToLoginRequestUrl||a.navigateToLoginRequestUrl},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!1},system:{loadFrameTimeout:a.timeout?a.timeout:6e3}})};s.push(f),o||(o=g)}}return o?(c.LoggingUtils.log("[Load->SsoSilentWrapper] "+o+": "+a.idp),h(o,a.upn,n?u.Constants.Authority.MsaSuffix:u.Constants.Authority.AadSuffix,t).then(function(e){return c.LoggingUtils.log("[Load->SsoSilentWrapper] "+o+": success: "+e.idTokenClaims.aud),C(!0,t,s,r)}).catch(function(e){return c.LoggingUtils.log("[Load->SsoSilentWrapper] "+o+": error: ["+e.errorCode+"]"+e.errorMessage),C(!0,t,s,r,e.errorCode,e.errorMessage)})):Promise.reject(C(!1,t,s,r))}).catch(function(){return c.LoggingUtils.log("[Load->MsalWrapper] msal is not loaded"),Promise.reject(C(!1,t,s,r))})}function p(e,t,r,i,s,g,f){var p=this;void 0===g&&(g=!1);var C=d.TimerUtils.timer(),T=i||s,y=!1,v=m(t),U={},M=a.idp.toLowerCase()===u.Constants.IdentityProvider.Msa.toLowerCase();if(r&&l.ValidateUtils.isGuid(r)||(r=void 0),!e)return U.ErrorCode="missing_target",U.ErrorMessage="The provided target for BrowserAuth.GetToken is null, blank or empty",Promise.reject(k(U,r,t,g,C,void 0));var A=[l.ValidateUtils.getScope(e)];if(!t||!l.ValidateUtils.isGuid(t))return U.ErrorCode="invalid_application_ID",U.ErrorMessage="The provided application ID for BrowserAuth.GetToken is null, blank, empty or with invalid format",Promise.reject(k(U,r,t,g,C,A));if(void 0===v||!v)return U.ErrorCode="missing_msal",U.ErrorMessage="BrowserAuth can't find msal instance",Promise.reject(k(U,r,t,g,C,void 0));var w=function(e){return new Promise(function(r,i){return n(p,void 0,void 0,function(){return o(this,function(n){switch(n.label){case 0:return c.LoggingUtils.log("[GetToken->acquireToken] "+t+": popup:["+T+"]"),U={},[4,(T?v.acquireTokenPopup(e):v.acquireTokenSilent(e)).then(function(e){return U.MsalResult=e,e.accessToken?l.ValidateUtils.upnMatchesUpnFromIdToken(e.idToken,a)&&(g||M||l.ValidateUtils.upnMatchesUpnFromAccessToken(e.accessToken,a))?(U.Token=e.accessToken,c.LoggingUtils.log("[GetToken->acquireToken] "+t+": success: "+U.Token),r(U)):(U.ErrorCode="upn_mismatch",U.ErrorMessage="upn doesn't match with given upn in config",c.LoggingUtils.log("[GetToken->acquireToken] "+t+": error: ["+U.ErrorCode+"]"+U.ErrorMessage),i(U)):(U.ErrorCode="no_tokens_found",U.ErrorMessage="Access token doesn't exist in auth response",c.LoggingUtils.log("[GetToken->acquireToken] "+t+": error: ["+U.ErrorCode+"]"+U.ErrorMessage),i(U))}).catch(function(n){if(U.MsalResult=n,U.ErrorCode=n.errorCode,U.ErrorMessage=n.errorMessage,c.LoggingUtils.log("[GetToken->acquireToken] "+t+": error: ["+U.ErrorCode+"]"+U.ErrorMessage),T||!y)return i(U);T=!0,c.LoggingUtils.log("[GetToken->acquireToken] "+t+": retry: popup:["+T+"]"),w(e).then(function(e){return r(e)}).catch(function(e){return i(e)})})];case 1:return n.sent(),[2]}})})})},b={scopes:A,account:{username:a.upn},loginHint:a.upn,extraQueryParameters:{domain_hint:M?u.Constants.Authority.MsaSuffix:u.Constants.Authority.AadSuffix},correlationId:r,claims:f};return w(b).catch(function(e){return n(p,void 0,void 0,function(){var i,s=this;return o(this,function(l){switch(l.label){case 0:return i=!1,"no_tokens_found"!==e.ErrorCode?[3,2]:(c.LoggingUtils.log("[GetToken->acquireToken] "+t+": no_tokens_found"),[4,h(t,a.upn,M?u.Constants.Authority.MsaSuffix:u.Constants.Authority.AadSuffix,r).then(function(){return n(s,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return c.LoggingUtils.log("[GetToken->acquireToken->SsoSilentWrapper] "+t+": success"),[4,w(b).then(function(e){i=!0,U=e}).catch(function(e){U=e})];case 1:return e.sent(),[2]}})})}).catch(function(e){return n(s,void 0,void 0,function(){return o(this,function(r){switch(r.label){case 0:return U.ErrorCode=e.errorCode,U.ErrorMessage=e.errorMessage,c.LoggingUtils.log("[GetToken->acquireToken->SsoSilentWrapper] "+t+": error: ["+U.ErrorCode+"]"+U.ErrorMessage),"login_required"===e.errorCode&&(e.errorMessage.startsWith("AADSTS50058")||e.errorMessage.startsWith("Silent authentication was denied"))&&a.autoPopup?(y=!0,[4,w(b).then(function(e){i=!0,U=e}).catch(function(e){c.LoggingUtils.log("[GetToken->acquireToken->SsoSilentWrapper->Popup] "+t+": error: ["+U.ErrorCode+"]"+U.ErrorMessage),U=e})]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}})})})]);case 1:l.sent(),l.label=2;case 2:return c.LoggingUtils.log("[GetToken->acquireToken->isSuccess] "+t+": ["+i+"]"),U=k(U,r,t,g,C,A),[2,i?Promise.resolve(U):Promise.reject(U)]}})})}).then(function(e){return c.LoggingUtils.log("[GetToken->acquireToken] "+t+": success"),Promise.resolve(k(e,r,t,g,C,A))})}function h(e,t,r,n){return m(e).ssoSilent({loginHint:t,extraQueryParameters:{domain_hint:r},correlationId:n})}function m(e){var t;if(s&&s.some(function(r){return e&&r.applicationId&&e.toUpperCase()===r.applicationId.toUpperCase()?(t=r.application,c.LoggingUtils.log("[GetApplication] "+e+": Found"),!0):(c.LoggingUtils.log("[GetApplication] "+e+": Not Found"),!1)}),!t&&i){c.LoggingUtils.log("[GetApplication] "+e+": Add"),t=new i.PublicClientApplication({auth:{clientId:e,authority:a.authority,redirectUri:a.redirectUri?a.redirectUri.split("?")[0]:location.href.split("?")[0],navigateToLoginRequestUrl:!a.navigateToLoginRequestUrl||a.navigateToLoginRequestUrl},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!1},system:{loadFrameTimeout:a.timeout?a.timeout:6e3}});var r={applicationId:e,application:t};s.push(r)}return t}function C(e,t,r,n,o,i){if(!a.telemetryInstance&&"undefined"==typeof OTel){var s=[{name:u.Constants.Telemetry.Duration,int64:n.ms},{name:u.Constants.Telemetry.Succeeded,bool:!0},{name:u.Constants.Telemetry.IdentityProvider,string:a.idp.toLowerCase()},{name:u.Constants.Telemetry.CorrelationId,string:t||"unknown"},{name:u.Constants.Telemetry.LoadedApplicationCount,int64:r?r.length:0},{name:u.Constants.Telemetry.ErrorCode,string:o||"unknown"},{name:u.Constants.Telemetry.ErrorMessage,string:i||"unknown"}];g.sendTelemetryEvent({name:u.Constants.Telemetry.LoadTelemetryName,dataFields:s})}return{Telemetry:{timeToLoad:n.ms,succeeded:e,idp:a.idp.toLowerCase(),correlationId:t||"",loadedApplicationCount:r?r.length:0,errorCode:o||void 0,errorMessage:i||void 0}}}function k(e,t,r,n,o,i){if(!a.telemetryInstance&&"undefined"==typeof OTel){var s=[{name:u.Constants.Telemetry.Duration,int64:o.ms},{name:u.Constants.Telemetry.Succeeded,string:!e.Token},{name:u.Constants.Telemetry.IdentityProvider,string:a.idp.toLowerCase()},{name:u.Constants.Telemetry.ApplicationId,string:r},{name:u.Constants.Telemetry.TokenScope,string:i&&!n?i.toString():"unknown"},{name:u.Constants.Telemetry.CorrelationId,string:t||"unknown"},{name:u.Constants.Telemetry.ErrorCode,string:e.ErrorCode?e.ErrorCode:"unknown"},{name:u.Constants.Telemetry.ErrorMessage,string:e.ErrorMessage&&!n?e.ErrorMessage:"unknown"},{name:u.Constants.Telemetry.ErrorCodeForGetToken,string:e.ErrorCode?e.ErrorCode:"unknown"},{name:u.Constants.Telemetry.ErrorMessageForGetToken,string:e.ErrorMessage&&!n?e.ErrorMessage:"unknown"}];g.sendTelemetryEvent({name:u.Constants.Telemetry.GetTokenTelemetryName,dataFields:s})}return e.Telemetry={timeToGetToken:o.ms,succeeded:!e.Token,idp:a.idp.toLowerCase(),applicationId:r,tokenScope:i&&!n?i.toString():void 0,correlationId:t,errorCode:e.ErrorCode?e.ErrorCode:void 0,errorMessage:e.ErrorMessage&&!n?e.ErrorMessage:void 0,errorCodeForGetToken:e.ErrorCode?e.ErrorCode:void 0,errorMessageForGetToken:e.ErrorMessage&&!n?e.ErrorMessage:void 0,fromCache:!!e.MsalResult&&!!e.MsalResult.fromCache,expiresOn:e.MsalResult&&e.MsalResult.expiresOn?e.MsalResult.expiresOn.getTime()/1e3:void 0},e}function T(e,t,r,n,o,i,s){var c=[{name:u.Constants.Telemetry.Duration,int64:n.ms},{name:u.Constants.Telemetry.Succeeded,bool:!i},{name:u.Constants.Telemetry.IdentityProvider,string:a.idp.toLowerCase()},{name:u.Constants.Telemetry.ApplicationId,string:r},{name:u.Constants.Telemetry.TokenScope,string:o?o.toString():"unknown"},{name:u.Constants.Telemetry.CorrelationId,string:t||"unknown"},{name:u.Constants.Telemetry.ErrorCode,string:i||"unknown"},{name:u.Constants.Telemetry.ErrorMessage,string:s||"unknown"},{name:u.Constants.Telemetry.ErrorCodeForCheckUpn,string:i||"unknown"},{name:u.Constants.Telemetry.ErrorMessageForCheckUpn,string:s||"unknown"}];a.telemetryInstance||"undefined"!=typeof OTel||g.sendTelemetryEvent({name:u.Constants.Telemetry.CheckUpnTelemetryName,dataFields:c}),e.Telemetry={timeToCheckUPN:n.ms,succeeded:!i,idp:a.idp.toLowerCase(),applicationId:r,tokenScope:o?o.toString():void 0,correlationId:t,errorCode:i,errorMessage:s,errorCodeForCheckUPN:i,errorMessageForCheckUPN:s}}g.addNamespaceMapping("Office.Identity.WebAuth.BrowserAuth","5c65bbc4edbf480d9637ace04d62bd98-12844893-8ab9-4dde-b850-5612cb12e0f2-7822"),t.Load=f,t.GetToken=p,t.GetTokenOnce=function(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=!1),f({idp:r?u.Constants.IdentityProvider.Msa.toLowerCase():u.Constants.IdentityProvider.Aad.toLowerCase(),appIds:[t],authority:n?u.Constants.Authority.Ppe:u.Constants.Authority.Prod,upn:"",autoPopup:!0,enableConsoleLogging:!0}).then(function(){return p(e,t,void 0,!0)}).catch(function(e){return Promise.reject(e)})},t.GetApplication=m,t.CheckUpnMatchIdToken=function(e,t){var r=d.TimerUtils.timer();t&&l.ValidateUtils.isGuid(t)||(t=void 0);var n={};if(!e||!l.ValidateUtils.isGuid(e))return n.ErrorCode="invalid_application_ID",n.ErrorMessage="The provided application ID for BrowserAuth.CheckUpnMatchIdToken is null, blank, empty or with invalid format",T(n,t,e,r,void 0,n.ErrorCode,n.ErrorMessage),Promise.reject(n);var o=m(e);if(void 0===o||!o)return n.ErrorCode="missing_msal",n.ErrorMessage="BrowserAuth can't find msal instance",Promise.reject();var i=[e];return new Promise(function(s,u){var d=o.getAccountByUsername(a.upn);c.LoggingUtils.log("[CheckUpnMatchIdToken] "+e+": Calls acquireTokenSilent"),o.acquireTokenSilent({scopes:i,account:d,correlationId:t}).then(function(o){if(n.IsUpnMatch=l.ValidateUtils.upnMatchesUpnFromIdToken(o.idToken,a),n.IsUpnMatch)return T(n,t,e,r,i),s(n)}).catch(function(o){return n.ErrorCode=o.errorCode,n.ErrorMessage=o.errorMessage,c.LoggingUtils.log("[CheckUpnMatchIdToken] "+e+": error: "+n.ErrorMessage),n.IsUpnMatch=!1,T(n,t,e,r,i,o.errorCode,o.errorMessage),u(n)})})},t.Logout=function(){s.forEach(function(e){c.LoggingUtils.log("[Logout] application calls logout"),e.application.logout()}),s=new Array}},"./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/Constants.ts":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){var t=function(){function e(){}return e.Aad="aad",e.Msa="msa",e}();e.IdentityProvider=t;var r=function(){function e(){}return e.RequestAuthConfig="RequestAuthConfig",e.ResponseAuthConfig="ResponseAuthConfig",e.iFrameIdTokenPrefix="msalIdTokenFrame",e.iFramePrefix="msalRenewFrame",e}();e.PostMessageType=r;var n=function(){function e(){}return e.Prod="https://login.microsoftonline.com/",e.ProdLegacy="https://login.windows.net/",e.Ppe="https://login.windows-ppe.net/",e.AadSuffix="organizations",e.MsaSuffix="consumers",e}();e.Authority=n;var o=function(){function e(){}return e.OtelInstance="otel",e.CheckUpnTelemetryName="Office.Identity.WebAuth.BrowserAuth.CheckUpn",e.GetTokenTelemetryName="Office.Identity.WebAuth.BrowserAuth.GetToken",e.LoadTelemetryName="Office.Identity.WebAuth.BrowserAuth.Load",e.Duration="Duration",e.Succeeded="Succeeded",e.ApplicationId="ApplicationId",e.CorrelationId="CorrelationId",e.IdentityProvider="IdentityProvider",e.LoadedApplicationCount="LoadedApplicationCount",e.TokenScope="TokenScope",e.ErrorCode="ErrorCode",e.ErrorMessage="ErrorMessage",e.ErrorCodeForLoad="ErrorCodeForLoad",e.ErrorMessageForLoad="ErrorMessageForLoad",e.ErrorCodeForGetToken="ErrorCodeForGetToken",e.ErrorMessageForGetToken="ErrorMessageForGetToken",e.ErrorCodeForCheckUpn="ErrorCodeForCheckUpn",e.ErrorMessageForCheckUpn="ErrorMessageForCheckUpn",e}();e.Telemetry=o}(t.Constants||(t.Constants={}))},"./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/ExtractUtils.ts":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/LoggingUtils.ts"),o=function(){function e(){}return e.extractToken=function(e){var t=this.decodeJwt(e);if(!t)return null;try{var r=t.JWSPayload,o=this.base64Decode(r);return o?JSON.parse(o):(n.LoggingUtils.log("The returned token could not be base64 url safe decoded."),null)}catch(e){n.LoggingUtils.error("The returned token could not be decoded"+e)}return null},e.base64Decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}return decodeURIComponent(atob(t).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))},e.decodeJwt=function(e){if("undefined"===e||!e||0===e.length)return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?(n.LoggingUtils.warn("The returned access_token is not parseable."),null):{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},e}();t.ExtractUtils=o},"./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/LoggingUtils.ts":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.log=function(e,t){return!!this.shouldProceed(t)&&(console.log(e),!0)},e.warn=function(e,t){return!!this.shouldProceed(t)&&(console.warn(e),!0)},e.error=function(e,t){return!!this.shouldProceed(t)&&(console.error(e),!0)},e.shouldProceed=function(e){return!(null!=e&&void 0!==e&&!e)&&!(null==e&&void 0===e&&!this.enableConsoleLogging)},e.enableConsoleLogging=!1,e}();t.LoggingUtils=n},"./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/TimerUtils.ts":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.timer=function(){var e=(new Date).getTime();return{get seconds(){return Math.ceil(((new Date).getTime()-e)/1e3)},get ms(){return(new Date).getTime()-e},get formattedSeconds(){return Math.ceil(this.seconds/1e3)+"s"},get formattedMs(){return this.ms+"ms"}}},e}();t.TimerUtils=n},"./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/ValidateUtils.ts":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/ExtractUtils.ts"),o=r("./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/Utils/LoggingUtils.ts"),i=function(){function e(){}return e.getScope=function(e){return["HTTPS:","API:"].some(function(t){return e.toLocaleUpperCase().startsWith(t)})||this.isGuid(e)?e+"/.default":e},e.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},e.upnMatchesUpnFromIdToken=function(e,t){if(!this.enableUpnCheck)return o.LoggingUtils.log("Skip Upn check of id token, returning true"),!0;if(!t||!t.upn)return o.LoggingUtils.log("Upn does not exist in the configuration, returning true"),!0;var r=n.ExtractUtils.extractToken(e);return!!(!r||r&&r.preferred_username&&r.preferred_username.toLowerCase()===t.upn.toLowerCase())||(o.LoggingUtils.log("provided Upn does not match Upn extracted from id token"),!1)},e.upnMatchesUpnFromAccessToken=function(e,t){if(!this.enableUpnCheck)return o.LoggingUtils.log("Skip Upn check of access token, returning true"),!0;if(!t||!t.upn)return o.LoggingUtils.log("Upn does not exist in the configuration, returning true"),!0;var r=n.ExtractUtils.extractToken(e);return!!(!r||r&&r.upn&&r.upn.toLowerCase()===t.upn.toLowerCase())||(o.LoggingUtils.log("provided Upn does not match Upn extracted from access token"),!1)},e.enableUpnCheck=!1,e}();t.ValidateUtils=i},0:function(e,t,r){r("./packages/Microsoft.Office.WebAuth.BrowserAuth/lib/api.js"),e.exports=r("./packages/Microsoft.Office.WebAuth.BrowserAuth/scripts/BrowserAuth.ts")}})});